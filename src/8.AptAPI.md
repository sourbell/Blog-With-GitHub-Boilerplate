---
layout: post
title: APT API
slug: apt-api
date: 2020-02-23 11:01
status: publish
author: Toby Bu
categories: 
  - Project Manage
tags: 
  - API
excerpt: APT API
---

默认返回结构

``` javascript
{
    meta: {
        error: false,
        code: null,
        message: null
    },
    data: {
        ...
    }
}
```

1, 登录
post /dashboard/login

[notice]已支持 Member & Coach 用户登录，待完成 Club / Accuro 用户[/notice]
    
``` javascript 
{ 
    email: "123456@qq.com", 
    password: "12345678" 
} 
```
    
``` javascript 
{ token: "120705de7e61c5b322ad798b8ef225a7" }
```


2, 注册（注册后默认为普通会员） TODO
    todo

3, 取回密码  TODO
post /dashboard/reset-password
    
``` javascript 
{ email: "123456@qq.com" } 
```
    
``` javascript 
{ message: "email sent" }
```


4, 获取用户最近统计数据  TODO
get /dashboard/statistics
    
``` javascript 
{
    weekly: {
        attendance: [0, 1, 1, 1, 1, 0, 1], //[6天前，5天前...，昨天，今天]
        calories: 756.23,
        exerciseMinutes: 320,
        zoneDuration: [120, 200, 240, 300, 500] //zone1~5 的分钟数
    },
    monthly: {
        attendance: [0, 1, 1, 1, 1, 1, 1... ] //[] 本月1号起至今天
        latestThirtyDays: [0, 1, 1, 1, 1 ...]
    },
        
}
```


5, 根据日期范围获取最近的 workout list 
post /dashboard/workouts/page/{page}
post /dashboard/workouts

[notice]已支持 Member & Coach 用户查询其邮箱对应的 Member Workout List[/notice]
    
``` javascript
{
    startTime: 1585383958, //可选，unix timestamp
    endTime: 1585583958, //可选，unix timestamp
    orderBy: "calories" | "pai" | "workoutStartTime" | "workoutTime" | "iqPoints" | "maxHr" | "avgHr",  //可选，严格大小写
    orderAscending: "DESC" | "ASC"  //可选，无所谓大小写
}
```
    
``` javascript
{
    "totalRecords": 1230,
    "pageSize": 10,
    "list": [{
        "calories": 372,
        "pai": 39.47,
        "deviceSn": "61P0002X7LF",
        "deviceName": "LYNK2-02X7",
        "actType": null,
        "workoutStartTime": 1582039076,
        "timezoneOffset": 8,
        "workoutTime": 1329,
        "maxHr": 184,
        "avgHr": 159,
        "highHr": 173,
        "iqPoints": 89.02,
        "zoneDuration": [ 0, 0, 157, 1020, 158 ],
        "hrSeries": [],
        "dataSource": "realtime" | "memory" | "ant" | "apt", //实时、离线、InClub、APT
        "workoutId": 2347083,
        "workoutEndTime": 1582040405
    }, 
    {...},
    ...]
}
```
    

6, 获取 workout 心率明细
get /dashboard/workouts/{workoutId}

[notice]已完成[/notice]
    
``` json
{
    "calories": 2286,
    "pai": 60.73,
    "workoutId": 1001129,
    "deviceSn": "61P0000C7DG",
    "deviceName": "LYNK2-00C7",
    "actType": null,
    "workoutStartTime": 1555924323,
    "timezoneOffset": 8,
    "workoutTime": 8742,
    "maxHr": 184,
    "avgHr": 154,
    "highHr": 201,
    "restingHr": null,
    "iqPoints": 550.18,
    "zoneDuration": [ 510, 1080, 1951, 1517, 3684 ],
    "hrSeries": [139, 138, 139, 140, 139, 138, 138, 138, 138, 138, 138, 138, 138, 137, 137, 137, 137, 137, 137 ... ],
    "dataSource": "memory",
    "endTime": 1555933065
}
```

7, 个人资料获取
get /dashboard/profile

[notice]已完成[/notice]
    
``` javascript 
{
    memberRole: "member" | "coach" | "club" | "accuro",
    email: "123456@qq.com",
    avatar: "",
    firstName: "Toby",
    lastName: "Bu",
    nickName: "Bristletail",
    gender: "male" | "female",
    birthYear: "01/1987",
    weight: 175.12, // unit lb
}
```


8, 个人资料修改 TODO
post /dashboard/profile
    
``` javascript 
{
    userId: 1,
    avatar: "",
    firstName: "Toby",
    lastName: "Bu",
    nickName: "Bristletail",
    gender: "male" | "female",
    birthYear: "01/1987",
    weight: 175.12,
    weightUnit: "lb" | "kg"
}
```

9, 修改密码 TODO
post /dashboard/profile/actions/change-password
    
``` javascript 
{ newPassword: "123456789" }
```
    
``` javascript 
{ message: "password changed" }
```

10, 获取本角色下的 Challenge list TODO

11, 根据日期范围获取全部或分页的 session list 
post /dashboard/sessions/page/{page}
post /dashboard/sessions
TODO: 针对 accuro 用户要支持传入 apt 用户
    
``` javascript
{
    startTime: 1585383958, //可选，unix timestamp
    endTime: 1585583958, //可选，unix timestamp
    orderBy: "startTime" | "totalCalories" | "avgCalories" | "avgHeartRate",  //可选，严格大小写
    orderAscending: "DESC" | "ASC"  //可选，无所谓大小写
}
```
    
``` javascript
[
    {
        "sessionId": 3191,
        "instructor": null, //null 则显示 Not Set
        "className": null, //null 则显示 Not Set
        "startTime": 1583120655,
        "timezoneOffset": 8,
        "classTime": 900, //预设的课程时间，如 15 分钟后课程自动结束
        "timeRemaining": 818, // 900-818 为实际课程时间，说明用户在 82 秒之后主动结束了课程
        "totalCalories":  4.2661547710325, // 显示小数点后一位， 如 4.3
        "avgCalories": 4.2661547710325, // 显示小数点后一位， 如 4.3
        "avgHeartRate": 98, //心率永远是整数
        "leaderboard": "[{\"iqPoints\": 1.35, \"nickName\": \"Evan\"}]", //返回 JSON.stringify 后的字符串
        "classMembers": "[{\"zone\": [82, 0, 0, 0, 0], \"email\": \"info@sourbell.im\", \"avgHr\": 98, \"maxHr\": 214, \"highHr\": 108, \"calories\": 4.343551457297644, \"hrSeries\": [78, 79, 80, 80, 81, 82, 82, 83, 84, 85, 86, 87, 91, 92, 92, 92, 92, 92, 92, 93, 93, 93, 93, 93, 93, 93, 94, 95, 95, 95, 95, 96, 97, 98, 98, 98, 98, 99, 100, 102, 104, 104, 104, 104, 105, 105, 105, 104, 103, 103, 102, 102, 103, 103, 104, 104, 106, 105, 105, 105, 105, 105, 105, 105, 105, 105, 106, 106, 106, 106, 106, 106, 106, 106, 106, 107, 107, 108, 108, 108, 108, 108], \"iqPoints\": 1.3666666666666667, \"lastName\": \"Bu\", \"memberId\": \"33e684a3-9110-4df7-a58f-183bd4ee1f66\", \"firstName\": \"Evan\", \"workoutStartTime\": 1583120652, \"zonePercentSettings\": [0, 60, 70, 80, 90]}]" //返回 JSON.stringify 后的字符串
    },
    {...},
    {...},
    ...
]
```



